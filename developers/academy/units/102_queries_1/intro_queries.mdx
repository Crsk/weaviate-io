---
title: Querying Weaviate
sidebar_position: 10
---

import imageUrl from '../../tmp_images/academy_placeholder.jpg';

## <i class="fa-solid fa-square-chevron-right"></i>&nbsp;&nbsp;Weaviate APIs

<img src={imageUrl} alt="Image alt" width="75%"/>

Weaviate provides both REST and GraphQL API interfaces. This section will explain the differences between the two and how they are used in Weaviate.

### <i class="fa-solid fa-chalkboard"></i>&nbsp;&nbsp;Uses in Weaviate

In Weaviate, REST and GraphQL interfaces are provided in a complementary fashion to provide a rich API for its users.

The REST API is used to interact with Weaviate for CRUD (Create, Read, Update and Delete) operations and to obtain metadata about the database. 

The GraphQL API is used to interact with Weaviate for data searches. More specifically, it can be used to retrieve data objects, aggregate information, and explore vector spaces.

In this unit, we will focus on various strategies to query Weaviate using GraphQL to retrieve information.

<details>
  <summary>What is REST?</summary>

REST is an acronym for **RE**presentational **S**tate **T**ransfer. 

A REST API provides multiple endpoints, each with its own URL, that can be used to interact with the API. 

The endpoints are organized into a hierarchy, with each endpoint representing a resource. The client can then request information about these resources by sending a request to the server.

</details>

<details>
  <summary>What is GraphQL?</summary>

GraphQL is a query language for APIs. 

First released by Facebook in 2015, it is now maintained by the GraphQL Foundation. 

GraphQL is a specification for a query language that can be used to request information from a server. GraphQL is a **strongly typed** language, which means that the client must specify the type of data that it wants to receive.

</details>

### <i class="fa-solid fa-chalkboard"></i>&nbsp;&nbsp;GraphQL syntax

Broadly, a GraphQL query will take this form:

```graphql
{
  <Function> {
    <Class> (<Arguments>) {
      <properties>
    }
  }
}
```

Where:
- `<Function>` is the action,
- `<Class>` is the target data collection,
- `<Arguments>` specifies any options, and
- `<properties>` describes the data to be retrieved.

<Quiz questions={varName} />

## <i class="fa-solid fa-square-chevron-right"></i>&nbsp;&nbsp;Running GraphQL queries

<img src={imageUrl} alt="Image alt" width="75%"/>

### <i class="fa-solid fa-code"></i>&nbsp;&nbsp;With a Weaviate client

Weaviate client libraries simplify the use of GraphQL syntax by abstracting it to syntax of the client's language. They also include functions to use raw GraphQL queries directly.

To help us focus on the query structures, we show raw GraphQL queries in this unit. You can run GraphQL queries in your respective language client as below:

import ClientGraphqlRaw from '../../_snippets/academy.clients.graphql.raw.mdx';

<ClientGraphqlRaw />

However, as we progress you will see more code examples using the client libraries as we do in the documentation.

### <i class="fa-solid fa-code"></i>&nbsp;&nbsp;With the Weaviate Console

<img src={imageUrl} alt="Image alt" width="75%"/>

Or you can do so on the [Weaviate Console](https://console.weaviate.io/), by logging in and connecting to your Weaviate instance.

:::warning TODO
Add steps for using GraphQL client if applicable to setup
:::

<!-- TODO - show specific steps to do this when WCS launches -->

<Quiz questions={varName} />

## <i class="fa-solid fa-square-chevron-right"></i>&nbsp;&nbsp;GraphQL functions

<img src={imageUrl} alt="Image alt" width="75%"/>

You can use `Get`, `Aggregate` or `Explore` GraphQL functions in Weaviate.

These three functions are used to `Get` objects, `Aggregate` information and `Explore` vector spaces. 

Let's review each one briefly, before we learn about them in detail in the following sections.

### <i class="fa-solid fa-chalkboard"></i>&nbsp;&nbsp;`Get` objects

The `Get` function is used in Weaviate to retrieve data objects. For many use cases, `Get` will be the most common type of query function used in Weaviate.

Take a look at the following:

```graphql
{
  Get {
    JeopardyQuestion (limit: 1) {
      question
      answer
    }
  }
}
```

This query applies the `Get` function to the `JeopardyQuestion` class, with an argument `limit: 1` which limits the number of returned objects to a maximum of 1. 

It should produce a response like the following:

```json
{
  "data": {
    "Get": {
      "JeopardyQuestion": [
        {
          "answer": "Amazon.com",
          "question": "On July 16, 1995 this company made its first sale, a science textbook"
        }
      ]
    }
  }
}
```

You can see that the response includes a data object from the `JeopardyQuestion` class, and values of its `question` and `answer` properties. 

### <i class="fa-solid fa-chalkboard"></i>&nbsp;&nbsp;`Aggregate` information

Whereas `Get` returns objects, `Aggregate` returns summary statistics or aggregates from the result set. 

As such you can use `Aggregate` to obtain summary values such as counts, sums, means and so on from groups of objects. 

For example, the following query will produce the maximum, minimum and mean of the `value` property in the `JeopardyQuestion` class.

```graphql
{
  Aggregate {
    JeopardyQuestion (limit: 100) {
      value {
        maximum
        minimum
        mean
      }
    }
  }
}
```

It should produce a response like the following:

```json
{
  "data": {
    "Aggregate": {
      "JeopardyQuestion": [
        {
          "value": {
            "maximum": 10000,
            "mean": 632.41,
            "minimum": 0
          }
        }
      ]
    }
  }
}
```

Notice that even though the query related to a maximum of 100 objects, the result was *one* set of aggregated values.

### <i class="fa-solid fa-chalkboard"></i>&nbsp;&nbsp;`Explore` vector spaces

`Explore` allows you to navigate the entire vector space of objects stored in Weaviate. 

This means that you can use `Explore` to find objects that are similar to a given object or vector, regardless of the class of the object. As such, `Explore` is very useful when you may not be sure of what class to search for.

In relation to our Quiz dataset, a query using the `Explore` function would return a set of objects from both the `JeopardyQuestion` and `Category` classes.

We will explore the `Explore` function in more detail in a separate, following unit.

<Quiz questions={varName} />

## <i class="fa-solid fa-square-chevron-right"></i>&nbsp;&nbsp;Review

<img src={imageUrl} alt="Image alt" width="75%"/>

### <i class="fa-solid fa-pen-to-square"></i>&nbsp;&nbsp;Review exercise

Can you describe, in your own sentence, XXX?

:::warning TODO
Input box for user to put answer in and get back a similarity score & our definition?
??
:::

### <i class="fa-solid fa-lightbulb-on"></i>&nbsp;&nbsp;Key takeaways

:::info
Add summary
:::

import Quiz from '/src/components/Academy/quiz.js'
const varName = [{
  questionText: 'questionText',
  answerOptions: [
    {
      answerText: 'answerOne',
      isCorrect: false,
      feedback: 'feedbackOne',
    },
    {
      answerText: 'answerTwo',
      isCorrect: false,
      feedback: 'feedbackTwo',
    },
    {
      answerText: 'answerThree',
      isCorrect: false,
      feedback: 'feedbackThree',
    },
  ]
}];